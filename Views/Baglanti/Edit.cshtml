@model BLBM_ENV.Models.Baglanti

@{
    ViewData["Title"] = "Bağlantı Düzenle";
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h1 class="h3 mb-0 text-gray-800">@ViewData["Title"]</h1>
        <p class="text-muted small">
            <i class="fas fa-server me-1"></i> @Model.SourceDevice?.DeviceName
            <i class="fas fa-arrow-right mx-2"></i>
            <i class="fas fa-server me-1"></i> @Model.TargetDevice?.DeviceName
        </p>
    </div>
    <a asp-controller="Envanter" asp-action="Details" asp-route-id="@Model.SourceDeviceID" class="btn btn-outline-secondary">
        <i class="fas fa-arrow-left me-1"></i> Geri Dön
    </a>
</div>

<div class="row">
    <div class="col-lg-12">
        <form asp-action="Edit">
            <div asp-validation-summary="ModelOnly" class="alert alert-danger" role="alert"></div>

            <input type="hidden" asp-for="ID" />
            <input type="hidden" asp-for="SourceDeviceID" />
            <input type="hidden" asp-for="TargetDeviceID" />
            <input type="hidden" asp-for="RowVersion" />

            <div class="card shadow mb-4">
                <div class="card-header py-3 bg-primary text-white">
                    <h6 class="m-0 font-weight-bold"><i class="fas fa-plug me-2"></i>Port ve Bağlantı Bilgileri</h6>
                </div>
                <div class="card-body">
                    <div class="row">
                        <!-- KAYNAK CİHAZ -->
                        <div class="col-md-6 border-end">
                            <h5 class="text-primary mb-3">Kaynak Cihaz (@Model.SourceDevice?.DeviceName)</h5>
                            <div class="form-floating mb-3">
                                <input asp-for="Source_Port" class="form-control" placeholder="Port" />
                                <label asp-for="Source_Port">Kaynak Port Adı (Örn: Gi1/0/1)</label>
                                <span asp-validation-for="Source_Port" class="text-danger"></span>
                            </div>
                            <div class="form-floating mb-3">
                                <input asp-for="Source_NicID" class="form-control" placeholder="NIC" />
                                <label asp-for="Source_NicID">NIC ID</label>
                            </div>
                        </div>

                        <!-- HEDEF CİHAZ -->
                        <div class="col-md-6">
                            <h5 class="text-success mb-3">Hedef Cihaz (@Model.TargetDevice?.DeviceName)</h5>
                            <div class="form-floating mb-3">
                                <input asp-for="Target_Port" class="form-control" placeholder="Port" />
                                <label asp-for="Target_Port">Hedef Port Adı</label>
                                <span asp-validation-for="Target_Port" class="text-danger"></span>
                            </div>
                            <div class="alert alert-info">
                                <small><i class="fas fa-info-circle me-1"></i> Bağlantı özellikleri (MAC, WWPN, Hız vb.) ortaktır ve aşağıdan yönetilir.</small>
                            </div>
                        </div>
                    </div>

                    <hr class="my-4" />

                    <!-- ORTAK BAĞLANTI ÖZELLİKLERİ -->
                    <h5 class="text-secondary mb-3"><i class="fas fa-cogs me-2"></i>Bağlantı Özellikleri</h5>

                    <div class="row g-3">
                        <div class="col-md-4">
                            <div class="form-floating">
                                <select asp-for="ConnectionType" class="form-select">
                                    <option value="">Seçiniz...</option>
                                    <option value="FC">FC (Fiber Channel)</option>
                                    <option value="Bakır">Bakır (Copper)</option>
                                    <option value="Virtual FC">Virtual FC</option>
                                    <option value="Virtual Bakır">Virtual Bakır</option>
                                </select>
                                <label asp-for="ConnectionType">Bağlantı Türü</label>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-floating">
                                <select asp-for="Source_LinkStatus" class="form-select">
                                    <option value="">Seçiniz...</option>
                                    <option value="Up">Up</option>
                                    <option value="Down">Down</option>
                                </select>
                                <label asp-for="Source_LinkStatus">Link Durumu</label>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-floating">
                                <input asp-for="Source_LinkSpeed" class="form-control" placeholder="Hız" />
                                <label asp-for="Source_LinkSpeed">Link Hızı (Örn: 10Gb)</label>
                            </div>
                        </div>
                    </div>

                    <div class="row g-3 mt-1">
                        <div class="col-md-4">
                            <div class="form-floating">
                                <input asp-for="Source_WWPN" class="form-control" placeholder="WWPN" />
                                <label asp-for="Source_WWPN">WWPN</label>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-floating">
                                <input asp-for="Source_BakirMAC" class="form-control" placeholder="Bakır MAC" />
                                <label asp-for="Source_BakirMAC">Bakır MAC</label>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-floating">
                                <input asp-for="Source_FiberMAC" class="form-control" placeholder="Fiber MAC" />
                                <label asp-for="Source_FiberMAC">Fiber MAC</label>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="card-footer text-end">
                    <button type="submit" class="btn btn-primary btn-lg">
                        <i class="fas fa-save me-1"></i> Değişiklikleri Kaydet
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }

    <script>
        $(document).ready(function () {
            // Sadece kaydetme animasyonu
            $('form').on('submit', function() {
                if ($(this).valid()) {
                    var btn = $(this).find('button[type="submit"]');
                    btn.prop('disabled', true);
                    btn.html('<i class="fas fa-spinner fa-spin me-2"></i> Kaydediliyor...');
                }
            });
        });
    </script>
}